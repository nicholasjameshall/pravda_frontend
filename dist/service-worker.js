(()=>{"use strict";var t={23:function(t,n,e){var o=this&&this.__awaiter||function(t,n,e,o){return new(e||(e=Promise))((function(i,r){function s(t){try{c(o.next(t))}catch(t){r(t)}}function a(t){try{c(o.throw(t))}catch(t){r(t)}}function c(t){var n;t.done?i(t.value):(n=t.value,n instanceof e?n:new e((function(t){t(n)}))).then(s,a)}c((o=o.apply(t,n||[])).next())}))};Object.defineProperty(n,"__esModule",{value:!0}),n.HttpService=void 0;const i=e(709),r=e(987);n.HttpService=class{constructor(){}get(t){return o(this,void 0,void 0,(function*(){const t={data:{textsToAnnotations:[["Earlier this month Mr Biden's lawyers said a first batch",[{annotation:i.TextAnnotation.CONTAINS_BIAS,votes:500,userSelection:r.VoteType.DOWNVOTE},{annotation:i.TextAnnotation.INACCURATE,votes:250,userSelection:r.VoteType.UPVOTE}]],["second batch of records was found",[{annotation:i.TextAnnotation.NO_SUPPORTING_EVIDENCE,votes:750,userSelection:r.VoteType.UPVOTE},{annotation:i.TextAnnotation.CONTAINS_BIAS,votes:200,userSelection:r.VoteType.UPVOTE},{annotation:i.TextAnnotation.INACCURATE,votes:-55,userSelection:r.VoteType.NO_VOTE}]],["Penn Biden Center",[{annotation:i.TextAnnotation.CONTAINS_BIAS,votes:-200,userSelection:r.VoteType.NO_VOTE}]]]}};return new Promise((n=>n(t)))}))}post(t){return o(this,void 0,void 0,(function*(){const t={data:{status:"Success!"}};return new Promise((n=>n(t)))}))}}},728:function(t,n){var e=this&&this.__awaiter||function(t,n,e,o){return new(e||(e=Promise))((function(i,r){function s(t){try{c(o.next(t))}catch(t){r(t)}}function a(t){try{c(o.throw(t))}catch(t){r(t)}}function c(t){var n;t.done?i(t.value):(n=t.value,n instanceof e?n:new e((function(t){t(n)}))).then(s,a)}c((o=o.apply(t,n||[])).next())}))};Object.defineProperty(n,"__esModule",{value:!0}),n.ServiceWorkerActionManager=void 0;class o{constructor(t){this.GET_ANNOTATIONS_URL="https://example.com/get_annotations",this.SAVE_ANNOTATIONS_URL="https://example.com/save_annotations",this.VOTE_ANNOTATION_URL="https://example.com/vote_annotation",this.httpService=t}showAnnotations(t){return e(this,void 0,void 0,(function*(){return console.log(t),chrome.tabs.sendMessage(t.tabId,{method:o.SHOW_ANNOTATIONS,data:t}).then((t=>t),(()=>{throw Error()}))}))}getAnnotations(t){return e(this,void 0,void 0,(function*(){const n={requestUrl:this.GET_ANNOTATIONS_URL,request:t};return this.httpService.get(n).then((t=>t.data))}))}saveAnnotations(t){return e(this,void 0,void 0,(function*(){const n={requestUrl:this.SAVE_ANNOTATIONS_URL,request:t};return this.httpService.post(n).then((t=>t.data))}))}voteAnnotation(t){return e(this,void 0,void 0,(function*(){const n={requestUrl:this.VOTE_ANNOTATION_URL,request:t};return this.httpService.post(n).then((t=>t.data))}))}}n.ServiceWorkerActionManager=o,o.SHOW_ANNOTATIONS="showAnnotations"},801:function(t,n){var e,o=this&&this.__awaiter||function(t,n,e,o){return new(e||(e=Promise))((function(i,r){function s(t){try{c(o.next(t))}catch(t){r(t)}}function a(t){try{c(o.throw(t))}catch(t){r(t)}}function c(t){var n;t.done?i(t.value):(n=t.value,n instanceof e?n:new e((function(t){t(n)}))).then(s,a)}c((o=o.apply(t,n||[])).next())}))};Object.defineProperty(n,"__esModule",{value:!0}),n.ContentActionManager=n.ContentAction=void 0,function(t){t.SAVE_ANNOTATIONS="saveAnnotations",t.VOTE_ANNOTATION="voteAnnotation"}(e=n.ContentAction||(n.ContentAction={})),n.ContentActionManager=class{constructor(){}saveAnnotations(t){return o(this,void 0,void 0,(function*(){return yield(2e3,new Promise((t=>setTimeout(t,2e3)))),this.sendRequestToServiceWorker(t,e.SAVE_ANNOTATIONS).then((t=>t))}))}voteAnnotation(t){return o(this,void 0,void 0,(function*(){return yield(2e3,new Promise((t=>setTimeout(t,2e3)))),this.sendRequestToServiceWorker(t,e.VOTE_ANNOTATION).then((t=>t))}))}sendRequestToServiceWorker(t,n){return o(this,void 0,void 0,(function*(){return chrome.runtime.sendMessage({method:n,data:t}).then((t=>t))}))}}},709:(t,n)=>{var e;Object.defineProperty(n,"__esModule",{value:!0}),n.toHumanFriendlyText=n.TextAnnotation=void 0,function(t){t.CONTAINS_BIAS="containsBias",t.INACCURATE="inaccurate",t.NO_SUPPORTING_EVIDENCE="noSupportingEvidence"}(e=n.TextAnnotation||(n.TextAnnotation={})),n.toHumanFriendlyText=function(t){switch(t){case e.CONTAINS_BIAS:return"Contains bias";case e.INACCURATE:return"Inaccurate";case e.NO_SUPPORTING_EVIDENCE:return"No supporting evidence";default:throw Error("Text annotation not found")}}},987:(t,n)=>{var e;Object.defineProperty(n,"__esModule",{value:!0}),n.VoteType=void 0,(e=n.VoteType||(n.VoteType={}))[e.UPVOTE=0]="UPVOTE",e[e.DOWNVOTE=1]="DOWNVOTE",e[e.NO_VOTE=2]="NO_VOTE"}},n={};function e(o){var i=n[o];if(void 0!==i)return i.exports;var r=n[o]={exports:{}};return t[o].call(r.exports,r,r.exports,e),r.exports}(()=>{const t=e(801),n=e(728),o=new(e(23).HttpService),i=new n.ServiceWorkerActionManager(o);chrome.runtime.onMessage.addListener(((n,e,o)=>{if(n.method==t.ContentAction.SAVE_ANNOTATIONS){const t=n.data;console.log(t),i.saveAnnotations(t).then((t=>{o(t)}))}if(n.method==t.ContentAction.VOTE_ANNOTATION){const t=n.data;console.log(t),i.voteAnnotation(t).then((t=>{o(t)}))}})),chrome.action.onClicked.addListener((t=>{const n=t.id?t.id:-1,e=t.url?t.url:"";if(-1==n||""==e)throw Error("Can't find tab");const o={url:e};i.getAnnotations(o).then((t=>{const e={tabId:n,textsToAnnotations:t.textsToAnnotations};return i.showAnnotations(e)})).then((t=>console.log(t)))}))})()})();